#!/bin/bash
#===============================================================================
# FILE:         cmus_status
#
# USAGE:        Execute in shell or other script
#
# DESCRIPTION:  Produces STATUS ARTIST TITLE output, with separators, etc.
#===============================================================================

#-------------------------------------------------------------------------------
# Get required data
#-------------------------------------------------------------------------------

status=$(cmus-remote -Q 2> /dev/null | grep 'status' | awk '{print $2}')
artist=$(cmus-remote -Q 2> /dev/null | grep 'tag artist' | awk '{$1=$2=""; print substr($0,3)}')
title=$(cmus-remote -Q 2> /dev/null | grep 'tag title' | awk '{$1=$2=""; print substr($0,3)}')

#-------------------------------------------------------------------------------
# Check artist
#-------------------------------------------------------------------------------

if [[ -z "$artist"  ]]; then
    artist="Unknown"
fi

#-------------------------------------------------------------------------------
# Check title
#-------------------------------------------------------------------------------

if [[ -z "$title"  ]]; then
    title="Unknown"
fi

#-------------------------------------------------------------------------------
# Check status
#-------------------------------------------------------------------------------

if [[ "$status" = "stopped" ]]; then
    echo ""
elif [[ "$status" = "paused" ]]; then
    echo "$artist : $title"
elif [[ "$status" = "playing" ]]; then
    echo "$artist : $title"
else
    echo "" # cmus is not running
fi
